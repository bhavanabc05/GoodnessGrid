{% extends "base.html" %} {% block title %}My Donations - Goodness Grid{%
endblock %} {% block content %}
<div class="container my-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1>üì¶ My Donations</h1>
    <div>
      <a href="/post-donation" class="btn btn-success me-2"
        >+ Post New Donation</a
      >
      <a href="/dashboard" class="btn btn-outline-success">Dashboard</a>
    </div>
  </div>

  {% if donations %}
  <p class="text-muted mb-4">
    You have posted {{ donations|length }} donation(s)
  </p>

  <div class="table-responsive">
    <table class="table table-hover">
      <thead class="table-success">
        <tr>
          <th>Type</th>
          <th>Description</th>
          <th>Quantity</th>
          <th>Status</th>
          <th>Posted On</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for donation in donations %}
        <tr>
          <td>
            {% if donation.type == 'food' %}üçΩÔ∏è {% elif donation.type ==
            'clothes' %}üëï {% elif donation.type == 'books' %}üìö {% elif
            donation.type == 'medicine' %}üíä {% elif donation.type ==
            'electronics' %}üíª {% elif donation.type == 'money' %}üí∞ {% else
            %}üì¶ {% endif %} {{ donation.type|capitalize }}
          </td>
          <td>
            {{ donation.description[:50] }}{% if donation.description|length >
            50 %}...{% endif %}
          </td>
          <td>{{ donation.quantity }}</td>
          <td>
            {% if donation.status == 'available' %}
            <span class="badge bg-success">Available</span>
            {% elif donation.status == 'claimed' %}
            <span class="badge bg-warning">Claimed</span>
            {% elif donation.status == 'completed' %}
            <span class="badge bg-info">Completed</span>
            {% else %}
            <span class="badge bg-secondary"
              >{{ donation.status|capitalize }}</span
            >
            {% endif %}
          </td>
          <td>{{ donation.created_at.strftime('%b %d, %Y') }}</td>
          <td>
            <button
              class="btn btn-sm btn-outline-primary view-details-btn"
              data-donation-id="{{ donation.donation_id }}"
            >
              View
            </button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="row mt-4">
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h3 class="text-success">{{ donations|length }}</h3>
          <p class="text-muted">Total Donations</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h3 class="text-warning">
            {% set claimed = donations|selectattr('status', 'equalto',
            'claimed')|list|length %} {{ claimed }}
          </h3>
          <p class="text-muted">Claimed</p>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card text-center">
        <div class="card-body">
          <h3 class="text-info">
            {% set completed = donations|selectattr('status', 'equalto',
            'completed')|list|length %} {{ completed }}
          </h3>
          <p class="text-muted">Completed</p>
        </div>
      </div>
    </div>
  </div>

  {% else %}
  <div class="alert alert-info text-center">
    <h4>You haven't posted any donations yet</h4>
    <p>Start making a difference by posting your first donation!</p>
    <a href="/post-donation" class="btn btn-success mt-2">Post Your Donation</a>
  </div>
  {% endif %}
</div>

<script>
  // Find all buttons with the class 'view-details-btn'
  const viewButtons = document.querySelectorAll(".view-details-btn");

  // Add a click event listener to each button
  viewButtons.forEach((button) => {
    button.addEventListener("click", function () {
      // 'this' refers to the button that was clicked
      // We get the ID from its 'data-donation-id' attribute
      const donationId = this.dataset.donationId;
      viewDetails(donationId);
    });
  });

  function viewDetails(donationId) {
    // Your original function remains the same
    alert("View details feature coming soon! Donation ID: " + donationId);
  }
</script>
{% endblock %}
